import{_ as n}from"./plugin-vue_export-helper-DlAUqK2U.js";import{o as s,c as a,a as t}from"./app-0RY1_pBP.js";const e={},p=t(`<h1 id="_17、weakset-和weakmap-md" tabindex="-1"><a class="header-anchor" href="#_17、weakset-和weakmap-md"><span>17、WeakSet 和WeakMap.md</span></a></h1><h2 id="从对象开始说起" tabindex="-1"><a class="header-anchor" href="#从对象开始说起"><span>从对象开始说起</span></a></h2><p>首先我们从大家都熟悉的对象开始说起。</p><div class="language-javascript line-numbers-mode" data-ext="js" data-title="js"><pre class="language-javascript"><code><span class="token keyword">const</span> algorithm <span class="token operator">=</span> <span class="token punctuation">{</span> <span class="token literal-property property">site</span><span class="token operator">:</span> <span class="token string">&quot;leetcode&quot;</span> <span class="token punctuation">}</span><span class="token punctuation">;</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>algorithm<span class="token punctuation">.</span>site<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// leetcode</span>

<span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">const</span> key <span class="token keyword">in</span> algorithm<span class="token punctuation">)</span> <span class="token punctuation">{</span>
  console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>key<span class="token punctuation">,</span> algorithm<span class="token punctuation">[</span>key<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token comment">// site leetcode</span>
<span class="token keyword">delete</span> algorithm<span class="token punctuation">.</span>site<span class="token punctuation">;</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>algorithm<span class="token punctuation">.</span>site<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// undefined</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>在上面的代码中，我们有一个 <em>algorithm</em> 对象，它的 <em>key</em> 和 <em>value</em> 是一个字符串类型的值，之后通过点（ . ）进行值的访问。</p><p>另外，<em>for-in</em> 循环也很适合在对象中循环。可以使用中括号（ [ ] ）访问其键对应的值。但是不能使用 <em>for-of</em> 循环，因为对象是不可迭代的。</p><p>对象的属性可以用 <em>delete</em> 关键字来删除。</p><p>好的，我们已经快速讨论了有关对象的一些事项：</p><ul><li>如何添加属性</li><li>如何遍历对象</li><li>如何删除属性</li></ul><h2 id="map" tabindex="-1"><a class="header-anchor" href="#map"><span><em>Map</em></span></a></h2><p><em>Map</em> 是 <em>JavaScript</em> 中新的集合对象，其功能类似于对象。但是，与常规对象相比，存在一些主要差异。</p><p>首先，让我们看一个创建 <em>Map</em> 对象的简单示例。</p><h3 id="添加属性" tabindex="-1"><a class="header-anchor" href="#添加属性"><span>添加属性</span></a></h3><p>首先，通过 <em>Map</em> 构造函数，我们可以创建一个 <em>Map</em> 实例对象出来，如下：</p><div class="language-javascript line-numbers-mode" data-ext="js" data-title="js"><pre class="language-javascript"><code><span class="token keyword">const</span> map <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Map</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token comment">// Map(0) {}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div></div></div><p><em>Map</em> 有一种特殊的方法可在其中添加称为 <em>set</em> 的属性。它有两个参数：键是第一个参数，值是第二个参数。</p><div class="language-javascript line-numbers-mode" data-ext="js" data-title="js"><pre class="language-javascript"><code>map<span class="token punctuation">.</span><span class="token function">set</span><span class="token punctuation">(</span><span class="token string">&#39;name&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;john&#39;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token comment">// Map(1) {&quot;name&quot; =&gt; &quot;john&quot;}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div></div></div><p>但是，它不允许你在其中添加现有数据。如果 <em>Map</em> 对象中已经存在与新数据的键对应的值，则不会添加新数据。</p><div class="language-javascript line-numbers-mode" data-ext="js" data-title="js"><pre class="language-javascript"><code>map<span class="token punctuation">.</span><span class="token function">set</span><span class="token punctuation">(</span><span class="token string">&#39;phone&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;iPhone&#39;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token comment">// Map(2) {&quot;name&quot; =&gt; &quot;john&quot;, &quot;phone&quot; =&gt; &quot;iPhone&quot;}</span>
map<span class="token punctuation">.</span><span class="token function">set</span><span class="token punctuation">(</span><span class="token string">&#39;phone&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;iPhone&#39;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token comment">// Map(2) {&quot;name&quot; =&gt; &quot;john&quot;, &quot;phone&quot; =&gt; &quot;iPhone&quot;}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>但是可以用其他值覆盖现有数据。</p><div class="language-javascript line-numbers-mode" data-ext="js" data-title="js"><pre class="language-javascript"><code>map<span class="token punctuation">.</span><span class="token function">set</span><span class="token punctuation">(</span><span class="token string">&#39;phone&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;Galaxy&#39;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token comment">// Map(2) {&quot;name&quot; =&gt; &quot;john&quot;, &quot;phone&quot; =&gt; &quot;Galaxy&quot;}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div></div></div><p>二维数组和 <em>Map</em> 对象之间可以很方便的相互转换。例如：</p><div class="language-javascript line-numbers-mode" data-ext="js" data-title="js"><pre class="language-javascript"><code><span class="token keyword">var</span> arr <span class="token operator">=</span> <span class="token punctuation">[</span>
    <span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
    <span class="token punctuation">[</span><span class="token number">3</span><span class="token punctuation">,</span> <span class="token number">4</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
    <span class="token punctuation">[</span><span class="token number">5</span><span class="token punctuation">,</span> <span class="token number">6</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
<span class="token punctuation">]</span><span class="token punctuation">;</span>

<span class="token keyword">var</span> map <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Map</span><span class="token punctuation">(</span>arr<span class="token punctuation">)</span><span class="token punctuation">;</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>map<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">//Map { 1 =&gt; 2, 3 =&gt; 4, 5 =&gt; 6 }</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>Array<span class="token punctuation">.</span><span class="token function">from</span><span class="token punctuation">(</span>map<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">//[ [ 1, 2 ], [ 3, 4 ], [ 5, 6 ] ]</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>关于 <em>Map</em> 和 <em>Object</em> 的区别，可以参阅下表：</p><figure><img src="https://xiejie-typora.oss-cn-chengdu.aliyuncs.com/2021-09-30-103632.png" alt="image-20210930183632548" tabindex="0" loading="lazy"><figcaption>image-20210930183632548</figcaption></figure><table><thead><tr><th></th><th>Map</th><th>Object</th></tr></thead><tbody><tr><td>额外的键</td><td>Map默认情况下不包含任何键，只包含插入的键</td><td>一个Object有一个圆形，原型链上的键名有可能和自己在对象上设置的键名产生冲突，ES5可以使用Object。create（null），创建一个没有原型的对象</td></tr><tr><td>键的类型</td><td>一个Map的键可以是任意值，包含函数，对象或者任意基本类型</td><td>一个Object的键必须是一个String或者Symbol</td></tr><tr><td>键的顺序</td><td>Map中的key是有序的，因此当迭代的时候，一个Map对象以插入的顺序返回键值</td><td>一个Object的键是无序的</td></tr><tr><td>size</td><td>通过size属性获取</td><td>Object的size只能手动计算</td></tr><tr><td>迭代</td><td>可迭代，可以直接被迭代</td><td>需要某种方式获取到键才能被迭代</td></tr><tr><td>性能</td><td>有频繁增删键值的情况下表现更好</td><td>未作出优化</td></tr></tbody></table><h2 id="weakmap" tabindex="-1"><a class="header-anchor" href="#weakmap"><span>weakMap</span></a></h2><p><strong>差异 <em>1</em>：<em>key</em> 必须是对象</strong></p><p>可以将任何值作为键传入 <em>Map</em> 对象，但 <em>WeakMap</em> 不同，它只接受一个对象作为键，否则，它将返回一个错误。</p><div class="language-javascript line-numbers-mode" data-ext="js" data-title="js"><pre class="language-javascript"><code><span class="token keyword">const</span> John <span class="token operator">=</span> <span class="token punctuation">{</span> <span class="token literal-property property">name</span><span class="token operator">:</span> <span class="token string">&#39;John&#39;</span> <span class="token punctuation">}</span><span class="token punctuation">;</span>
<span class="token keyword">const</span> weakMap <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">WeakMap</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
weakMap<span class="token punctuation">.</span><span class="token function">set</span><span class="token punctuation">(</span>John<span class="token punctuation">,</span> <span class="token string">&#39;student&#39;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token comment">// WeakMap {{...} =&gt; &quot;student&quot;}</span>
weakMap<span class="token punctuation">.</span><span class="token function">set</span><span class="token punctuation">(</span><span class="token string">&#39;john&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;student&#39;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token comment">// Uncaught TypeError: Invalid value used as weak map key</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p><strong>差异 <em>2</em>：并非 <em>Map</em> 中的所有方法都支持</strong></p><p><em>WeakMap</em> 可以使用的方法如下：</p><ul><li><em>delete</em></li><li><em>get</em></li><li><em>has</em></li><li><em>set</em></li></ul><p>还有一个最大的不同是 <em>WeakMap</em> 不支持迭代对象的方法（foreach等方法）。</p><p><strong>差异 <em>3</em>：当 <em>GC</em> 清理引用时，数据会被删除</strong></p><p>这是和 <em>Map</em> 相比最大的不同。</p><p>例如：</p><div class="language-javascript line-numbers-mode" data-ext="js" data-title="js"><pre class="language-javascript"><code><span class="token keyword">let</span> John <span class="token operator">=</span> <span class="token punctuation">{</span> <span class="token literal-property property">major</span><span class="token operator">:</span> <span class="token string">&quot;math&quot;</span> <span class="token punctuation">}</span><span class="token punctuation">;</span>

<span class="token keyword">const</span> map <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Map</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">const</span> weakMap <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">WeakMap</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

map<span class="token punctuation">.</span><span class="token function">set</span><span class="token punctuation">(</span>John<span class="token punctuation">,</span> <span class="token string">&#39;John&#39;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
weakMap<span class="token punctuation">.</span><span class="token function">set</span><span class="token punctuation">(</span>John<span class="token punctuation">,</span> <span class="token string">&#39;John&#39;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

John <span class="token operator">=</span> <span class="token keyword">null</span><span class="token punctuation">;</span>
<span class="token comment">/* John 被垃圾收集 */</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>当 <em>John</em> 对象被垃圾回收时，<em>Map</em> 对象将保持引用链接，而 <em>WeakMap</em> 对象将丢失链接。</p><h2 id="set" tabindex="-1"><a class="header-anchor" href="#set"><span><em>Set</em></span></a></h2><p><em>Set</em> 也非常类似于 <em>Map</em>，但是 <em>Set</em> 对于单个值更有用。</p><h3 id="添加属性-1" tabindex="-1"><a class="header-anchor" href="#添加属性-1"><span>添加属性</span></a></h3><p>使用 <em>add</em> 方法可以添加属性。</p><div class="language-javascript line-numbers-mode" data-ext="js" data-title="js"><pre class="language-javascript"><code><span class="token keyword">const</span> set <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Set</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

set<span class="token punctuation">.</span><span class="token function">add</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
set<span class="token punctuation">.</span><span class="token function">add</span><span class="token punctuation">(</span><span class="token string">&#39;john&#39;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
set<span class="token punctuation">.</span><span class="token function">add</span><span class="token punctuation">(</span><span class="token function">BigInt</span><span class="token punctuation">(</span><span class="token number">10</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token comment">// Set(4) {1, &quot;john&quot;, 10n}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>与 <em>Map</em> 一样，<em>Set</em> 也不允许添加相同的值。</p><div class="language-javascript line-numbers-mode" data-ext="js" data-title="js"><pre class="language-javascript"><code>set<span class="token punctuation">.</span><span class="token function">add</span><span class="token punctuation">(</span><span class="token number">5</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token comment">// Set(1) {5}</span>

set<span class="token punctuation">.</span><span class="token function">add</span><span class="token punctuation">(</span><span class="token number">5</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token comment">// Set(1) {5}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>对于原始数据类型（<em>boolean、number、string、null、undefined</em>），如果储存相同值则只保存一个，对于引用类型,引用地址完全相同则只会存一个。</p><ul><li><em>+0</em> 与 <em>-0</em> 在存储判断唯一性的时候是恒等的，所以不可以重复。</li><li><em>undefined</em> 和 <em>undefined</em> 是恒等的，所以不可以重复。</li><li><em>NaN</em> 与 <em>NaN</em> 是不恒等的，但是在 <em>Set</em> 中只能存一个不能重复。</li></ul><h3 id="遍历对象" tabindex="-1"><a class="header-anchor" href="#遍历对象"><span>遍历对象</span></a></h3><p>由于 <em>Set</em> 是一个可迭代的对象，因此可以使用 <em>for-of</em> 或 <em>forEach</em> 语句。</p><div class="language-javascript line-numbers-mode" data-ext="js" data-title="js"><pre class="language-javascript"><code><span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">const</span> val <span class="token keyword">of</span> set<span class="token punctuation">)</span> <span class="token punctuation">{</span>
  console<span class="token punctuation">.</span><span class="token function">dir</span><span class="token punctuation">(</span>val<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
<span class="token comment">// 1</span>
<span class="token comment">// &#39;John&#39;</span>
<span class="token comment">// 10n</span>
<span class="token comment">// 5</span>

set<span class="token punctuation">.</span><span class="token function">forEach</span><span class="token punctuation">(</span><span class="token parameter">val</span> <span class="token operator">=&gt;</span> console<span class="token punctuation">.</span><span class="token function">dir</span><span class="token punctuation">(</span>val<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token comment">// 1</span>
<span class="token comment">// &#39;John&#39;</span>
<span class="token comment">// 10n</span>
<span class="token comment">// 5</span>

</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="删除属性" tabindex="-1"><a class="header-anchor" href="#删除属性"><span>删除属性</span></a></h3><p>这一部分和 <em>Map</em> 的删除完全一样。如果数据被成功删除，它返回 <em>true</em>，否则返回 <em>false</em>。</p><p>当然也可以使用 clear 方法清空 <em>Set</em> 集合。</p><div class="language-javascript line-numbers-mode" data-ext="js" data-title="js"><pre class="language-javascript"><code>set<span class="token punctuation">.</span><span class="token function">delete</span><span class="token punctuation">(</span><span class="token number">5</span><span class="token punctuation">)</span><span class="token punctuation">;</span> 
<span class="token comment">// true</span>
set<span class="token punctuation">.</span><span class="token function">delete</span><span class="token punctuation">(</span><span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token comment">// false;</span>

set<span class="token punctuation">.</span><span class="token function">clear</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>如果你不想将相同的值添加到数组表单中，则 <em>Set</em> 可能会非常有用。</p><div class="language-javascript line-numbers-mode" data-ext="js" data-title="js"><pre class="language-javascript"><code><span class="token comment">/* With Set */</span>
<span class="token keyword">const</span> set <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Set</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
set<span class="token punctuation">.</span><span class="token function">add</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
set<span class="token punctuation">.</span><span class="token function">add</span><span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
set<span class="token punctuation">.</span><span class="token function">add</span><span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
set<span class="token punctuation">.</span><span class="token function">add</span><span class="token punctuation">(</span><span class="token number">3</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
set<span class="token punctuation">.</span><span class="token function">add</span><span class="token punctuation">(</span><span class="token number">3</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token comment">// Set {1, 2, 3}</span>

<span class="token comment">// Converting to Array</span>
<span class="token keyword">const</span> arr <span class="token operator">=</span> <span class="token punctuation">[</span> <span class="token operator">...</span>set <span class="token punctuation">]</span><span class="token punctuation">;</span>
<span class="token comment">// [1, 2, 3]</span>

<span class="token class-name">Object</span><span class="token punctuation">.</span>prototype<span class="token punctuation">.</span><span class="token function">toString</span><span class="token punctuation">.</span><span class="token function">call</span><span class="token punctuation">(</span>arr<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token comment">// [object Array]</span>

<span class="token comment">/* Without Set */</span>
<span class="token keyword">const</span> <span class="token function-variable function">hasSameVal</span> <span class="token operator">=</span> <span class="token parameter">val</span> <span class="token operator">=&gt;</span> ar<span class="token punctuation">.</span><span class="token function">some</span><span class="token punctuation">(</span>v <span class="token operator">===</span> val<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">const</span> ar <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">;</span>

<span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span><span class="token function">hasSameVal</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">)</span> ar<span class="token punctuation">.</span><span class="token function">push</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span><span class="token function">hasSameVal</span><span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">)</span> ar<span class="token punctuation">.</span><span class="token function">push</span><span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span><span class="token function">hasSameVal</span><span class="token punctuation">(</span><span class="token number">3</span><span class="token punctuation">)</span><span class="token punctuation">)</span> ar<span class="token punctuation">.</span><span class="token function">push</span><span class="token punctuation">(</span><span class="token number">3</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="应用场景" tabindex="-1"><a class="header-anchor" href="#应用场景"><span>应用场景</span></a></h3><p>接下来来看一下 <em>Set</em> 常见的应用场景：</p><div class="language-javascript line-numbers-mode" data-ext="js" data-title="js"><pre class="language-javascript"><code><span class="token comment">//数组去重</span>
<span class="token operator">...</span><span class="token keyword">new</span> <span class="token class-name">Set</span><span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">2</span><span class="token punctuation">,</span><span class="token number">2</span><span class="token punctuation">,</span><span class="token number">3</span><span class="token punctuation">]</span><span class="token punctuation">)</span>

<span class="token comment">//并集</span>
<span class="token keyword">var</span> arr1 <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">]</span>
<span class="token keyword">var</span> arr2 <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">,</span> <span class="token number">4</span><span class="token punctuation">]</span>
<span class="token keyword">var</span> newArr <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token operator">...</span><span class="token keyword">new</span> <span class="token class-name">Set</span><span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token operator">...</span>arr1<span class="token punctuation">,</span> <span class="token operator">...</span>arr2<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">]</span>
<span class="token comment">//交集</span>
<span class="token keyword">var</span> arr1 <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">]</span>
<span class="token keyword">var</span> arr2 <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">,</span> <span class="token number">4</span><span class="token punctuation">]</span>
<span class="token keyword">var</span> set1 <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Set</span><span class="token punctuation">(</span>arr1<span class="token punctuation">)</span>
<span class="token keyword">var</span> set2 <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Set</span><span class="token punctuation">(</span>arr2<span class="token punctuation">)</span>
<span class="token keyword">var</span> newArr <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span>
set1<span class="token punctuation">.</span><span class="token function">forEach</span><span class="token punctuation">(</span><span class="token parameter">item</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
    set2<span class="token punctuation">.</span><span class="token function">has</span><span class="token punctuation">(</span>item<span class="token punctuation">)</span> <span class="token operator">?</span> newArr<span class="token punctuation">.</span><span class="token function">push</span><span class="token punctuation">(</span>item<span class="token punctuation">)</span> <span class="token operator">:</span> <span class="token string">&#39;&#39;</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>newArr<span class="token punctuation">)</span>
<span class="token comment">//差集</span>
<span class="token keyword">var</span> arr1 <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">]</span>
<span class="token keyword">var</span> arr2 <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">,</span> <span class="token number">4</span><span class="token punctuation">]</span>
<span class="token keyword">var</span> set1 <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Set</span><span class="token punctuation">(</span>arr1<span class="token punctuation">)</span>
<span class="token keyword">var</span> set2 <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Set</span><span class="token punctuation">(</span>arr2<span class="token punctuation">)</span>
<span class="token keyword">var</span> newArr <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span>
set1<span class="token punctuation">.</span><span class="token function">forEach</span><span class="token punctuation">(</span><span class="token parameter">item</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
    set2<span class="token punctuation">.</span><span class="token function">has</span><span class="token punctuation">(</span>item<span class="token punctuation">)</span> <span class="token operator">?</span> <span class="token string">&#39;&#39;</span> <span class="token operator">:</span> newArr<span class="token punctuation">.</span><span class="token function">push</span><span class="token punctuation">(</span>item<span class="token punctuation">)</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>
set2<span class="token punctuation">.</span><span class="token function">forEach</span><span class="token punctuation">(</span><span class="token parameter">item</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
    set1<span class="token punctuation">.</span><span class="token function">has</span><span class="token punctuation">(</span>item<span class="token punctuation">)</span> <span class="token operator">?</span> <span class="token string">&#39;&#39;</span> <span class="token operator">:</span> newArr<span class="token punctuation">.</span><span class="token function">push</span><span class="token punctuation">(</span>item<span class="token punctuation">)</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>newArr<span class="token punctuation">)</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h2 id="weakset" tabindex="-1"><a class="header-anchor" href="#weakset"><span><em>WeakSet</em></span></a></h2><p><em>WeakSet</em> 和 <em>Set</em> 区别如下：</p><ul><li><em>WeakSet</em> 只能储存对象引用，不能存放值，而 <em>Set</em> 对象都可以</li><li><em>WeakSet</em> 对象中储存的对象值都是被弱引用的，即垃圾回收机制不考虑 <em>WeakSet</em> 对该对象的引用，如果没有其他的变量或者属性引用这个对象值，则这个对象将会被垃圾回收掉。（不考虑该对象还存在与 <em>WeakSet</em> 中），所以 <em>WeakSet</em> 对象里有多少个成员元素，取决于垃圾回收机制有没有运行，运行前后成员个数可能不一致，遍历结束之后，有的成员可能取不到，被垃圾回收了。因此 <em>ES6</em> 规定，<em>WeakSet</em> 对象是无法被遍历的，也没有办法拿到它包含的所有元素。</li></ul><p><em>WeakSet</em> 能够使用的方法如下：</p><ul><li><em>add(value)</em> 方法：在 <em>WeakSet</em> 中添加一个元素。如果添加的元素已存在，则不会进行操作。</li><li><em>delete(value)</em> 方法：删除元素 <em>value</em></li><li><em>has(value)</em> 方法：判断 <em>WeakSet</em> 对象中是否包含 <em>value</em></li><li><em>clear( )</em> 方法：清空所有元素</li></ul><p>下面来看一下 <em>WeakSet</em> 的代码示例，与 <em>WeakMap</em> 一样，<em>WeakSet</em> 也将丢失对内部数据的访问链接（如果内部数据已被垃圾收集）。</p><div class="language-javascript line-numbers-mode" data-ext="js" data-title="js"><pre class="language-javascript"><code><span class="token keyword">let</span> John <span class="token operator">=</span> <span class="token punctuation">{</span> <span class="token literal-property property">major</span><span class="token operator">:</span> <span class="token string">&quot;math&quot;</span> <span class="token punctuation">}</span><span class="token punctuation">;</span>

<span class="token keyword">const</span> set <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Set</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">const</span> weakSet <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">WeakSet</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

set<span class="token punctuation">.</span><span class="token function">add</span><span class="token punctuation">(</span>John<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token comment">// Set {{...}}</span>
weakSet<span class="token punctuation">.</span><span class="token function">add</span><span class="token punctuation">(</span>John<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token comment">// WeakSet {{...}}</span>

John <span class="token operator">=</span> <span class="token keyword">null</span><span class="token punctuation">;</span>
<span class="token comment">/* John 被垃圾收集 */</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>一旦对象 <em>John</em> 被垃圾回收，<em>WeakSet</em> 就无法访问其引用 <em>John</em> 的数据。而且 <em>WeakSet</em> 不支持 <em>for-of</em> 或 <em>forEach</em>，因为它不可迭代。</p><h2 id="比较总结" tabindex="-1"><a class="header-anchor" href="#比较总结"><span>比较总结</span></a></h2><ul><li><p><em>Map</em></p><ul><li>键名唯一不可重复</li><li>类似于集合，键值对的集合，任何值都可以作为一个键或者一个值</li><li>可以遍历，可以转换各种数据格式，方法 <em>get、set、has、delete</em></li></ul></li><li><p><em>WeakMap</em></p><ul><li>只接受对象为键名，不接受其他类型的值作为键名，键值可以是任意</li><li>键名是拖引用，键名所指向的对象，会被垃圾回收机制回收</li><li>不能遍历，方法 <em>get、set、has、delete</em></li></ul></li><li><p><em>Set</em></p><ul><li>成员唯一，无序且不会重复</li><li>类似于数组集合，键值和键名是一致的（只有键值。没有键名）</li><li>可以遍历，方法有 <em>add、delete、has</em></li></ul></li><li><p><em>WeakSet</em></p><ul><li>只能存储对应引用，不能存放值</li><li>成员都是弱引用，会被垃圾回收机制回收</li><li>不能遍历，方法有 <em>add、delete、has</em></li></ul></li></ul>`,70),o=[p];function c(l,i){return s(),a("div",null,o)}const r=n(e,[["render",c],["__file","17、WeakSet 和WeakMap.html.vue"]]),d=JSON.parse('{"path":"/%E9%9D%A2%E8%AF%95%E7%AC%94%E8%AE%B0/%E6%B8%A1%E4%B8%80%E5%89%8D%E7%AB%AF/17%E3%80%81WeakSet%20%E5%92%8CWeakMap.html","title":"17、WeakSet 和WeakMap.md","lang":"zh-CN","frontmatter":{"category":["JS基础"],"description":"17、WeakSet 和WeakMap.md 从对象开始说起 首先我们从大家都熟悉的对象开始说起。 在上面的代码中，我们有一个 algorithm 对象，它的 key 和 value 是一个字符串类型的值，之后通过点（ . ）进行值的访问。 另外，for-in 循环也很适合在对象中循环。可以使用中括号（ [ ] ）访问其键对应的值。但是不能使用 for...","head":[["meta",{"property":"og:url","content":"https://mister-hope.github.io/%E9%9D%A2%E8%AF%95%E7%AC%94%E8%AE%B0/%E6%B8%A1%E4%B8%80%E5%89%8D%E7%AB%AF/17%E3%80%81WeakSet%20%E5%92%8CWeakMap.html"}],["meta",{"property":"og:site_name","content":"ErWin的博客"}],["meta",{"property":"og:title","content":"17、WeakSet 和WeakMap.md"}],["meta",{"property":"og:description","content":"17、WeakSet 和WeakMap.md 从对象开始说起 首先我们从大家都熟悉的对象开始说起。 在上面的代码中，我们有一个 algorithm 对象，它的 key 和 value 是一个字符串类型的值，之后通过点（ . ）进行值的访问。 另外，for-in 循环也很适合在对象中循环。可以使用中括号（ [ ] ）访问其键对应的值。但是不能使用 for..."}],["meta",{"property":"og:type","content":"article"}],["meta",{"property":"og:image","content":"https://xiejie-typora.oss-cn-chengdu.aliyuncs.com/2021-09-30-103632.png"}],["meta",{"property":"og:locale","content":"zh-CN"}],["meta",{"property":"og:updated_time","content":"2024-04-10T07:11:45.000Z"}],["meta",{"property":"article:author","content":"Mr.ErWin"}],["meta",{"property":"article:modified_time","content":"2024-04-10T07:11:45.000Z"}],["script",{"type":"application/ld+json"},"{\\"@context\\":\\"https://schema.org\\",\\"@type\\":\\"Article\\",\\"headline\\":\\"17、WeakSet 和WeakMap.md\\",\\"image\\":[\\"https://xiejie-typora.oss-cn-chengdu.aliyuncs.com/2021-09-30-103632.png\\"],\\"dateModified\\":\\"2024-04-10T07:11:45.000Z\\",\\"author\\":[{\\"@type\\":\\"Person\\",\\"name\\":\\"Mr.ErWin\\",\\"url\\":\\"https://gitee.com/destiny12327\\"}]}"]]},"headers":[{"level":2,"title":"从对象开始说起","slug":"从对象开始说起","link":"#从对象开始说起","children":[]},{"level":2,"title":"Map","slug":"map","link":"#map","children":[{"level":3,"title":"添加属性","slug":"添加属性","link":"#添加属性","children":[]}]},{"level":2,"title":"weakMap","slug":"weakmap","link":"#weakmap","children":[]},{"level":2,"title":"Set","slug":"set","link":"#set","children":[{"level":3,"title":"添加属性","slug":"添加属性-1","link":"#添加属性-1","children":[]},{"level":3,"title":"遍历对象","slug":"遍历对象","link":"#遍历对象","children":[]},{"level":3,"title":"删除属性","slug":"删除属性","link":"#删除属性","children":[]},{"level":3,"title":"应用场景","slug":"应用场景","link":"#应用场景","children":[]}]},{"level":2,"title":"WeakSet","slug":"weakset","link":"#weakset","children":[]},{"level":2,"title":"比较总结","slug":"比较总结","link":"#比较总结","children":[]}],"git":{"createdTime":1712733105000,"updatedTime":1712733105000,"contributors":[{"name":"ma","email":"destiny0402@163.com","commits":1}]},"readingTime":{"minutes":6.96,"words":2087},"filePathRelative":"面试笔记/渡一前端/17、WeakSet 和WeakMap.md","localizedDate":"2024年4月10日","excerpt":"\\n<h2>从对象开始说起</h2>\\n<p>首先我们从大家都熟悉的对象开始说起。</p>\\n<div class=\\"language-javascript\\" data-ext=\\"js\\" data-title=\\"js\\"><pre class=\\"language-javascript\\"><code><span class=\\"token keyword\\">const</span> algorithm <span class=\\"token operator\\">=</span> <span class=\\"token punctuation\\">{</span> <span class=\\"token literal-property property\\">site</span><span class=\\"token operator\\">:</span> <span class=\\"token string\\">\\"leetcode\\"</span> <span class=\\"token punctuation\\">}</span><span class=\\"token punctuation\\">;</span>\\nconsole<span class=\\"token punctuation\\">.</span><span class=\\"token function\\">log</span><span class=\\"token punctuation\\">(</span>algorithm<span class=\\"token punctuation\\">.</span>site<span class=\\"token punctuation\\">)</span><span class=\\"token punctuation\\">;</span> <span class=\\"token comment\\">// leetcode</span>\\n\\n<span class=\\"token keyword\\">for</span> <span class=\\"token punctuation\\">(</span><span class=\\"token keyword\\">const</span> key <span class=\\"token keyword\\">in</span> algorithm<span class=\\"token punctuation\\">)</span> <span class=\\"token punctuation\\">{</span>\\n  console<span class=\\"token punctuation\\">.</span><span class=\\"token function\\">log</span><span class=\\"token punctuation\\">(</span>key<span class=\\"token punctuation\\">,</span> algorithm<span class=\\"token punctuation\\">[</span>key<span class=\\"token punctuation\\">]</span><span class=\\"token punctuation\\">)</span><span class=\\"token punctuation\\">;</span>\\n<span class=\\"token punctuation\\">}</span>\\n\\n<span class=\\"token comment\\">// site leetcode</span>\\n<span class=\\"token keyword\\">delete</span> algorithm<span class=\\"token punctuation\\">.</span>site<span class=\\"token punctuation\\">;</span>\\nconsole<span class=\\"token punctuation\\">.</span><span class=\\"token function\\">log</span><span class=\\"token punctuation\\">(</span>algorithm<span class=\\"token punctuation\\">.</span>site<span class=\\"token punctuation\\">)</span><span class=\\"token punctuation\\">;</span> <span class=\\"token comment\\">// undefined</span>\\n</code></pre></div>","autoDesc":true}');export{r as comp,d as data};
